@page "/purchasing/vendor"

<TableSection Title="Vendor"
              Link="/purchasing"
              LinkText="Purchasing">

    <Topbar>
        <TableToolbar Placeholder="Vendor Name" OnSearchChanged="SearchChanged"/>
    </Topbar>

    <Thead>
    <tr>
        <th class="min-width">
            <h6>#</h6>
        </th>
        <th data-sortable class="@(_vendorParameters.OrderBy switch { "VendorName desc" => "desc", "VendorName asc" => "asc", _ => ""})" onclick="@(() => SortChanged("VendorName"))">
            <a class="dataTable-sorter">
                <h6>Vendor Name</h6>
            </a>
        </th>
        <th class="min-width">
            <h6>Status</h6>
        </th>
        <th class="min-width">
            <h6>Priority</h6>
        </th>
        <th class="min-width">
            <h6>Register</h6>
        </th>
        <th class="min-width">
            <h6>Modified</h6>
        </th>
        <th data-sortable class="@(_vendorParameters.OrderBy switch { "vendorWeburl desc" => "desc", "vendorWeburl asc" => "asc", _ => ""})" onclick="@(() => SortChanged("vendorWeburl"))">
            <a class="dataTable-sorter">
                <h6>Web URL</h6>
            </a>
        </th>
        <th class="min-width">
            <h6 class="text-sm text-medium">
                <a a class="text-primary" href="#" data-bs-toggle="modal" data-bs-target="#@("addVendor")" @onclick="Clear">
                    Add <span class="mdi mdi-layers-plus"></span>
                </a>
            </h6>
        </th>
    </tr>
    </Thead>
    <Tbody>

    @foreach (var item in VendorListPaging)
    {
        <tr>
            <td>
                <p>-</p>
            </td>
            <td class="min-width">
                <p>@item.VendorName </p>
            </td>
            <td>
                <p>
                    @{
                        if (@item.VendorActive)
                        {
                            <span class="status-btn success-btn">Active</span>
                        }
                        else
                        {
                            <span class="status-btn warning-btn">Deactive</span>
                        }
                    }
                </p>
            </td>
            <td>
                <p>
                    @{
                        if (@item.VendorPriority)
                        {
                            <span class="status-btn success-btn">Primary</span>
                        }
                        else
                        {
                            <span class="status-btn warning-btn">Secondary</span>
                        }
                    }
                </p>
            </td>
            <td>
                <p>@item.VendorRegisterTime</p>
            </td>
            <td >
                <p>@item.VendorModifiedDate</p>
            </td>
            <td class="min-width">
                <p>@item.VendorWeburl</p>
            </td>
            <td>
                <button class="more-btn ml-10 dropdown-toggle text-gray" id="moreAction" data-bs-toggle="dropdown" aria-expanded="false" title="more">
                    <span class="mdi mdi-dots-vertical mdi-2x"></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="moreAction">
                    <li class="dropdown-item">
                        <a class="text-gray" href="javascript:void(0)" data-bs-toggle="modal" data-bs-target="#edit" @onclick="() => OnUpdate(item)"> Edit </a>
                    </li>
                    <li class="dropdown-item">
                        <a class="text-gray" href="/purchasing/vendor-product/@item.VendorEntityId"> Add Item Product </a>
                    </li>
                    <li class="dropdown-item">
                        <a class="text-danger" href="" data-bs-toggle="modal" data-bs-target="#@($"delete{@item.VendorEntityId}")"
                           data-item-id="@item.VendorEntityId">
                            Delete
                        </a>
                    </li>
                </ul>
            </td>
        </tr>
    }

    </Tbody>
    <Tfoot>
        <TablePagination MetaData="MetaData" Spread="2" SelectedPage="SelectedPage"/>
    </Tfoot>
</TableSection>

<SuccessNotification @ref="_notification"/>

<!-- Modal Add Vendor -->
<div class="warning-modal">
    <div class="modal fade" id="@("addVendor")" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <EditForm autocomplete="off" class="modal-content card-style" Model="_vendor" OnValidSubmit="Create">
                <DataAnnotationsValidator/>
                <div class="modal-header px-0 border-0">
                    <h5 class="text-bold">Add Vendor</h5>
                    <button type="button" class="border-0 bg-transparent h1" data-bs-dismiss="modal">
                        <i class="lni lni-cross-circle"></i>
                    </button>
                </div>
                <div class="modal-body px-0">
                    <div class="row">
                        <div class="input-style-1">
                            <label for="name">Vendor Name</label>
                            <div class="select-position">
                                <InputText id="vendorName" data-value="" @bind-Value="_vendor.VendorName"/>
                                <ValidationMessage For="@(() => _vendor.VendorName)"/>
                            </div>
                        </div>
                        <div class="select-style-1 col-6 rounded-sm">
                            <label>Status</label>
                            <div class="select-position">
                                <InputSelect @bind-Value="_vendor.VendorActive" class="form-control">
                                    <option value="true">Active</option>
                                    <option value="false">Inactive</option>
                                </InputSelect>
                            </div>
                        </div>
                        <div class="select-style-1 col-6 rounded-sm">
                            <label>Priority</label>
                            <div class="select-position">
                                <InputSelect @bind-Value="_vendor.VendorPriority" class="form-control">
                                    <option value="true">Priority</option>
                                    <option value="false" selected>NotPriority</option>
                                </InputSelect>
                            </div>
                        </div>
                        <div class="input-style-1 col-8 rounded-sm">
                            <label>Website</label>
                            <div class="select-position">
                                <InputText id="VendorWeburl" @bind-Value="_vendor.VendorWeburl" placeholder="URL..."/>
                                <ValidationMessage For="@(() => _vendor.VendorWeburl)"/>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="action d-flex flex-wrap justify-content-end">
                    <button type="button" data-bs-dismiss="modal" class="main-btn danger-btn-outline btn-hover m-1">
                        Cancel
                    </button>
                    <button data-bs-dismiss="modal" class="main-btn primary-btn btn-hover m-1" disabled="false">
                        Save
                    </button>
                </div>
            </EditForm>
        </div>
    </div>
</div>

<!-- Modal Edit Vendor -->
<div class="warning-modal">
        <div class="modal fade" id="edit" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <EditForm class="modal-content card-style" Model="_vendor" OnValidSubmit="OnUpdateConfirmed">
                    <div class="modal-header px-0 border-0">
                        <h5 class="text-bold">Edit Vendor</h5>
                        <button type="button" class="border-0 bg-transparent h1" data-bs-dismiss="modal">
                            <i class="lni lni-cross-circle"></i>
                        </button>
                    </div>
                    <div class="modal-body px-0">
                        <div class="row">
                            <div class="input-style-1 col-9 rounded-sm">
                                <label>Vendor Name</label>
                                <div class="select-position">
                                    <InputText id="vendorName" data-value="" @bind-Value="_vendor.VendorName"/>
                                    <ValidationMessage For="@(() => _vendor.VendorName)"/> 
                                </div>
                            </div>
                            <div class="select-style-1 col-6 rounded-sm">
                                <label>Status</label>
                                <div class="select-position">
                                <InputSelect @bind-Value="_vendor.VendorActive">
                                    <option value="true">Active</option>
                                    <option value="false">Inactive</option>
                                </InputSelect>
                                </div>
                            </div>
                            <div class="select-style-1 col-6 rounded-sm">
                                <label>Priority</label>
                                <div class="select-position">
                                <InputSelect @bind-Value="_vendor.VendorPriority">
                                    <option value="true">Priority</option>
                                    <option value="false" >NotPriority</option>
                                </InputSelect>
                                </div>
                            </div>
                            <div class="input-style-1 col-8 rounded-sm">
                                <label>Website</label>
                                <div class="select-position">
                                    <InputText id="VendorWeburl" @bind-Value="_vendor.VendorWeburl" placeholder="URL..."/>
                                    <ValidationMessage For="@(() => _vendor.VendorWeburl)"/>
                                </div>
                            </div>
                        </div>
                        <div class="action d-flex flex-wrap justify-content-end">
                            <button type="button" data-bs-dismiss="modal" class="main-btn danger-btn-outline btn-hover m-1" @onclick="Clear">
                                Cancel
                            </button>
                            <button type="submit" class="main-btn primary-btn btn-hover m-1">
                                Send
                            </button>
                        </div>
                    </div>
                </EditForm>
            </div>
        </div>
    </div>

@foreach (var item in VendorListPaging)
{
    <!-- Seragam Modal Delete Vendor-->
    <div class="warning-modal">
        <div class="modal fade" id="@($"delete{item.VendorEntityId}")" tabindex="-1" aria-hidden="true" role="dialog">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content card-style warning-card text-center">
                    <div class="modal-body">
                        <div class="icon text-danger mb-20">
                            <i class="lni lni-warning"></i>
                        </div>
                        <div class="content mb-30">
                            <h2 class="mb-15">Warning!</h2>
                            <h5> Vendor will be deleted? </h5>
                            <p class="text-sm text-medium">
                                Data that has been deleted cannot be recovered
                            </p>
                        </div>
                        <div class="action d-flex flex-wrap justify-content-center">
                            <button data-bs-dismiss="modal" class="main-btn light-btn-outline rounded-full btn-hover m-1">
                                Cancel
                            </button>
                            <button data-bs-dismiss="modal" class="main-btn danger-btn rounded-full btn-hover m-1" @onclick="() => DeleteConfirmed(item.VendorEntityId)">
                                Continue
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@code {

    [Parameter]
    public int Id { get; set; }

}